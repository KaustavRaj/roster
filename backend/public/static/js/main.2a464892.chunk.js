(this.webpackJsonproster=this.webpackJsonproster||[]).push([[0],{152:function(e,t,n){},185:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},241:function(e,t,n){},310:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(24),o=n.n(c),s=(n(185),n(20)),i=n.n(s),l=n(32),d=n(18),u=n(34),j=n(33),b=n(29),f=n.n(b),p=n(65),O=n(318),h=n(175),g=n(92),x=n(56),m=n(54),v=n(316),y=n(81),k=n.n(y),C=n(165),T=n(324),w=n(22),S=n(88),D=n(322),A=n(57),E=n(123),R=n(3);var L=function(e){var t=e.userData,n=e.showToolTip,r=e.showRemove,c=e.onRemove,o=Object(S.a)(e,["userData","showToolTip","showRemove","onRemove"]),s=Object(R.jsx)(D.a,Object(w.a)(Object(w.a)({style:{backgroundColor:"green",verticalAlign:"middle",cursor:"pointer"}},o),{},{children:function(e){if(e)return e.split(" ").slice(0,2).map((function(e){return e.toUpperCase()[0]})).join("")}(t.name)}),e.key),i=Object(R.jsx)(A.a,{title:Object(R.jsxs)(a.Fragment,{children:[t.name,r?Object(R.jsx)(x.a,{type:"text",icon:Object(R.jsx)(E.a,{size:"large"}),onClick:function(){return c(t.id)}}):null]}),placement:"top",children:s},e.key);return n?i:s},I=Object(a.createContext)({});function N(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(I),o=c.globalState,s=c.globalDispatch,i=Object(j.g)(),l=function(e){r(e)},b=function(){f.a.post("/logout").then((function(e){e.data.success&&(s({type:"LOGOUT"}),i.push("/login"))}),(function(e){console.log("error",e)}))},p=function(){i.push("/login")},O=function(){return null},h=function(){return Object(R.jsx)(u.b,{to:"/boards",children:Object(R.jsx)("div",{style:{textAlign:"center",fontSize:24,color:"white"},children:"Roster"})})},v=function(){return Object(R.jsx)(g.a,{justify:"end",align:"middle",children:Object(R.jsx)(m.a,{children:o.isAuthenticated?Object(R.jsx)(C.a,{placement:"bottomRight",content:Object(R.jsx)(y,{}),trigger:"click",visible:n,onVisibleChange:l,children:Object(R.jsx)(L,{userData:o.userData})}):Object(R.jsx)(x.a,{ghost:!0,onClick:p,children:"Log In"})})})},y=function(){return Object(R.jsx)(x.a,{type:"text",icon:Object(R.jsx)(T.a,{},"setting"),style:{padding:0},onClick:b,children:"Log out"})};return Object(R.jsx)("header",{style:{backgroundColor:"#046994",paddingTop:5,paddingBottom:5,paddingRight:32,paddingLeft:32,minHeight:"5vh"},children:Object(R.jsxs)(g.a,{align:"middle",children:[Object(R.jsx)(m.a,{span:8,children:Object(R.jsx)(O,{})}),Object(R.jsx)(m.a,{span:8,children:Object(R.jsx)(h,{})}),Object(R.jsx)(m.a,{span:8,children:Object(R.jsx)(v,{})})]})})}var B=n(319),_=n(320),P=n(317);n(210);function F(e){var t=Object(a.useContext)(I).globalState,n=t.userData,r=n.id,c=n.name,o=Object(a.useState)(""),s=Object(d.a)(o,2),u=s[0],j=s[1],b=Object(a.useState)([{id:r,name:c}]),p=Object(d.a)(b,2),O=p[0],v=p[1],y=Object(a.useState)(),k=Object(d.a)(y,2),C=k[0],T=k[1],S=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t).length>0&&f.a.get("/users/search?q=".concat(n)).then((function(e){var t=e.data.data;console.log(t),t.length?T(t.map((function(e){return{key:e.id,value:e.name}}))):T([])}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){e!==t.userData.id&&v((function(t){return t.filter((function(t){return t.id!==e}))}))};return Object(R.jsx)(B.a,{title:"New Board",visible:e.visible,footer:null,onCancel:e.onClose,children:Object(R.jsxs)(g.a,{gutter:[0,20],children:[Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(_.a,{size:"large",placeholder:"Board name",className:"rounded",onChange:function(e){j(e.target.value)},value:u})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(P.a,{style:{width:"100%"},onSearch:S,options:C,onSelect:function(e,t){if(T([]),0===O.filter((function(e){return e.id===t.key})).length){var n={id:t.key,name:t.value};v((function(e){return e.concat([n])}))}},children:Object(R.jsx)(_.a.Search,{size:"large",placeholder:"Add members",enterButton:!0})})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)("strong",{children:"Members"})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(D.a.Group,{maxCount:5,children:O.map((function(e){return Object(R.jsx)(L,{showToolTip:!0,showRemove:!0,userData:e,onRemove:A},e.id)}))})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(x.a,{block:!0,type:"primary",onClick:function(){var t={name:u,members:O.map((function(e){return e.id}))},n=function(e){h.b.error("Failed to create board"),console.error("POST /boards : ",e)};f.a.post("/boards",{data:Object(w.a)({},t)},{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data,r=a.success,c=a.error,o=a.data;r?(h.b.success("".concat(u," created successfully")),e.onCreate(o)):(console.log("HERE"),n(c))}),n),e.onClose()},children:"Create"})})]})})}var z=n(314),G=n(325),H=n(312);var U=function(e){var t=e.children,n=e.onConfirm,r=Object(a.useState)(!1),c=Object(d.a)(r,2),o=c[0],s=c[1],i=function(){s(!1)};return Object(R.jsx)(H.a,{title:"Are you sure you want to delete this?",visible:o,onVisibleChange:function(e){s(e)},onConfirm:function(){i(),n()},onCancel:i,okText:"Yes",cancelText:"No",children:t})};n(211);function J(e){var t=e.boardData,n=e.onDelete,a="/".concat(t.id,"/dashboard");return Object(R.jsx)(u.b,{to:a,children:Object(R.jsx)(z.a,{title:t.name,hoverable:!0,className:"flashcard",style:{backgroundColor:"rgba(36, 145, 227, 0.7)"},extra:Object(R.jsx)(U,{onConfirm:function(){return n(t.id)},children:Object(R.jsx)(x.a,{shape:"circle",type:"text",icon:Object(R.jsx)(G.a,{twoToneColor:"black"})})}),children:Object(R.jsx)(D.a.Group,{maxCount:3,children:t.members.map((function(e){return Object(R.jsx)(L,{userData:e,showToolTip:!0},"".concat(t.id,"_").concat(e.id))}))})})})}var q=O.a.Content;O.a.Header;function M(e){return Object(R.jsxs)(O.a,{style:{backgroundColor:"transparent",minHeight:"100vh"},children:[Object(R.jsx)(N,{}),Object(R.jsx)(q,{children:e})]})}var W=function(e){var t=e.component,n=Object(S.a)(e,["component"]),r=Object(a.useContext)(I).globalState;return console.log("GLOBAL STATE",r),Object(R.jsx)(j.b,Object(w.a)(Object(w.a)({},n),{},{render:function(e){return r.isAuthenticated?M(Object(R.jsx)(t,Object(w.a)({},e))):Object(R.jsx)(j.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},V=n(313),Y=n(326),K=v.a.Title,Q=v.a.Paragraph,X=O.a.Sider,Z=O.a.Header,$=O.a.Content;function ee(e){var t=e.methods,n=e.updateTasksList,r=e.itemData.id,c=e.stageData.id,o=Object(j.h)().board_id,s="/".concat(o,"/dashboard/task?task_id=").concat(r),u=Object(a.useState)(""),b=Object(d.a)(u,2),v=b[0],y=b[1],C=Object(a.useState)(""),T=Object(d.a)(C,2),w=T[0],S=T[1],A=Object(a.useState)([]),E=Object(d.a)(A,2),N=E[0],_=E[1],F=Object(a.useState)(!0),z=Object(d.a)(F,2),G=z[0],H=z[1],J=Object(a.useState)(!1),q=Object(d.a)(J,2),M=q[0],W=q[1],ee=Object(a.useState)([]),te=Object(d.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useContext)(I).globalState;Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get(s).then((function(e){var t=e.data,n=t.success,a=t.error,r=t.data;if(console.log("getTaskDetails",e),n){var c=null!=r.assigned.find((function(e){return e.id===re.userData.id}));y(r.title),S(r.description),_(r.assigned),W(c)}else Object(h.b)("Couldn't retrive task details"),console.error(a)}),(function(e){console.error("GET ".concat(s),e)})).finally((function(){H(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.a.get("/boards/multiple",{params:{boardIds:JSON.stringify([o])},paramsSerializer:function(e){return k.a.stringify(e)}}).then((function(e){var t=e.data,n=t.success,a=(t.error,t.data);console.log(a[0]),n&&ae(a[0].members.map((function(e){return{key:e.id,value:e.name}})))}),(function(e){console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),e()}),[o,r]);var ce=function(e){t.removeAssigned(r,e,(function(){_((function(t){return t.filter((function(t){return t.id!==e}))}))}))},oe=Object(R.jsx)("div",{style:{minWidth:"100hw",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(R.jsx)(p.PropagateLoader,{color:"#1890ff",size:30})});return Object(R.jsx)(B.a,{visible:e.visible,footer:null,onCancel:e.handleClose,width:"45vw",style:{minWidth:450},children:G?oe:Object(R.jsxs)(O.a,{style:{backgroundColor:"transparent"},children:[Object(R.jsx)(Z,{style:{backgroundColor:"transparent",paddingLeft:0},children:Object(R.jsx)(K,{level:4,editable:{icon:Object(R.jsx)(Y.a,{}),tooltip:"Edit title",onChange:function(e){t.changeTaskTitle(r,e,(function(){n(r,{toUpdate:"title",newTitle:e},(function(){y(e)}))}))}},children:v})}),Object(R.jsx)($,{children:Object(R.jsxs)(O.a,{style:{backgroundColor:"transparent"},children:[Object(R.jsxs)($,{style:{paddingRight:20},children:[Object(R.jsx)(K,{level:5,children:"Description"}),Object(R.jsx)(Q,{editable:{icon:Object(R.jsx)(Y.a,{}),tooltip:"Edit description",onChange:function(e){t.changeTaskDescription(r,e,(function(){S(e)}))}},children:w}),Object(R.jsx)(K,{level:5,children:"Assigned"}),Object(R.jsx)(g.a,{children:Object(R.jsx)(P.a,{style:{width:"100%"},placeholder:"Add members to assign",options:ne,onSelect:function(e,n){var a=n.key;if(0===N.filter((function(e){return e.id===a})).length){var c={id:a,name:e};t.addAssigned(r,a,(function(){_((function(e){return e.concat([c])}))}))}}})}),Object(R.jsx)(g.a,{children:Object(R.jsx)(D.a.Group,{maxCount:5,style:{marginTop:10},children:N.map((function(e){return Object(R.jsx)(L,{userData:e,showToolTip:!0,showRemove:!0,onRemove:ce},"".concat(r,"_").concat(e.id))}))})})]}),Object(R.jsxs)(X,{style:{backgroundColor:"transparent"},children:[Object(R.jsxs)(g.a,{children:[Object(R.jsx)(m.a,{span:12,children:Object(R.jsx)(x.a,{onClick:function(){t.joinTask(r,(function(){W(!0)}))},type:"primary",disabled:M,style:{width:"100%"},children:M?"Joined":"Join Task"})}),Object(R.jsx)(m.a,{span:12,children:Object(R.jsx)(U,{onConfirm:function(){t.deleteTask(r,c,(function(){n(r,{toUpdate:"remove"},(function(){e.handleClose()}))}))},children:Object(R.jsx)(x.a,{type:"dashed",color:"red",style:{width:"100%"},children:"Delete Task"})})})]}),Object(R.jsx)(V.a,{}),Object(R.jsx)(Q,{strong:!0,children:"Move to"}),Object(R.jsx)(g.a,{gutter:[0,6],children:e.stagesList.map((function(n){return n.id!==c&&Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(x.a,{block:!0,type:"dashed",onClick:function(){return a=n,void t.moveTask(r,c,a.id,e.index,(function(){h.b.success("Task moved to ".concat(a.name))}));var a},children:n.name})},n.id)}))})]})]})})]})})}var te=n(87);function ne(e){var t=e.itemData,n=e.index,r=Object(a.useState)(!1),c=Object(d.a)(r,2),o=c[0],s=c[1],i=function(){s(!0)},l=function(){s(!1)};return t?Object(R.jsx)(te.b,{draggableId:t.id,index:n,children:function(n){return Object(R.jsxs)("div",Object(w.a)(Object(w.a)(Object(w.a)({ref:n.innerRef},n.dragHandleProps),n.draggableProps),{},{children:[Object(R.jsx)("div",{style:{backgroundColor:"white",marginLeft:6,marginRight:6,marginBottom:5,marginTop:4,paddingTop:5,paddingBottom:5,paddingLeft:10,borderRadius:4,boxShadow:"0px 2px 0px rgba(0,0,0,0.1)",cursor:"pointer"},onClick:i,children:t.title}),Object(R.jsx)(ee,Object(w.a)({visible:o,handleClose:l},e))]}))}}):null}var ae=n(122),re=n(69),ce=n(179);function oe(e){var t=e.methods,n=e.stageData,r=Object.assign({},n),c=Object(a.useState)([]),o=Object(d.a)(c,2),s=o[0],u=o[1],j=Object(a.useState)(!1),b=Object(d.a)(j,2),f=b[0],p=b[1],O=Object(a.useState)(""),v=Object(d.a)(O,2),y=v[0],k=v[1];Object(a.useEffect)((function(){console.log("got stageData",n);var e=Array.from(n.tasks);e.sort((function(e,t){return e.position-t.position})),u(e)}),[n.tasks]);var C=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(y.length>0)){e.next=3;break}return e.next=3,t.addTask(r.id,y,(function(e,t){t?h.b.error("Failed to create task"):S(e.id,{toUpdate:"add",newTask:e}),T()}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){k(""),p(!1)},S=function(e,t,n){var a=t.toUpdate,r=t.newTitle,c=t.newTask;switch(console.log("updateTasksList...."),a){case"title":console.log("setting title..."),u(Object(ae.a)(s).map((function(t){return t.id===e?Object(w.a)(Object(w.a)({},t),{},{title:r}):t})));break;case"add":console.log("adding task..."),c.position=s.length,u((function(e){return e.concat(c)}));break;case"remove":console.log("removing task..."),u((function(t){return t.filter((function(t){return t.id!==e}))}));break;default:console.log("nothing to update...")}n&&(console.log("callback..."),n())},D=Object(R.jsx)(g.a,{justify:"space-between",style:{width:"100%",paddingTop:5,paddingBottom:5,paddingLeft:20,paddingRight:10},children:Object(R.jsx)(m.a,{children:Object(R.jsx)("strong",{children:r.name})})}),A=Object(R.jsx)("div",{style:{width:"100%",paddingBottom:5,paddingTop:5,marginLeft:6,marginRight:6,marginBottom:5,marginTop:4},children:f?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(_.a,{style:{backgroundColor:"white",paddingTop:5,paddingBottom:5,paddingLeft:10,borderRadius:4,marginBottom:10,boxShadow:"0px 2px 0px rgba(0,0,0,0.1)",cursor:"text"},placeholder:"Enter a title for this card...",onPressEnter:C,onChange:function(e){k(e.target.value)}}),Object(R.jsx)(x.a,{style:{backgroundColor:"green",color:"white",borderRadius:5},onClick:C,children:"Add Card"}),Object(R.jsx)(x.a,{type:"text",icon:Object(R.jsx)(re.a,{}),onClick:T})]}):Object(R.jsx)(x.a,{type:"text",icon:Object(R.jsx)(ce.a,{}),onClick:function(){p(!0)},children:"Add another card"})});return Object(R.jsxs)(g.a,{style:{backgroundColor:"rgba(36, 145, 227, 0.5)",borderRadius:5},children:[D,Object(R.jsx)(te.c,{droppableId:r.id,children:function(t){return Object(R.jsxs)("div",Object(w.a)(Object(w.a)({ref:t.innerRef},t.droppableProps),{},{style:{width:"100%"},children:[s.map((function(t,n){return t&&Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(ne,Object(w.a)({itemData:t,index:n,updateTasksList:S},e),t.id)},t.id)})),t.placeholder]}))}}),A]})}var se=n(321);var ie=function(e){return Object(R.jsx)(se.a,{status:"404",title:"404",subTitle:"Sorry, the page you're looking for does not exist.",extra:Object(R.jsx)(u.b,{to:"/boards",children:Object(R.jsx)(x.a,{type:"primary",children:"Back Home"})})})};var le=function(e){var t=Object(j.h)().board_id,n=Object(a.useContext)(I).globalState,r=Object(a.useState)([]),c=Object(d.a)(r,2),o=c[0],s=c[1],u=Object(a.useState)(),b=Object(d.a)(u,2),p=b[0],O=b[1];Object(a.useEffect)((function(){(function(){var n=Object(l.a)(i.a.mark((function n(){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=function(t){console.error(t),e.onClose()},f.a.get("/boards/multiple",{params:{boardIds:JSON.stringify([t])},paramsSerializer:function(e){return k.a.stringify(e)}}).then((function(e){var t=e.data,n=t.success,r=t.error,c=t.data,o=null==c?null:c[0];n&&o?s(c[0].members):a(r)}),(function(e){a(e)}));case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]);var v=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t).length>0&&f.a.get("/users/search?q=".concat(n)).then((function(e){var t=e.data.data;console.log(t),t.length?O(t.map((function(e){return{key:e.id,value:e.name}}))):O([])}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(e){e!==n.userData.id&&s((function(t){return t.filter((function(t){return t.id!==e}))}))};return Object(R.jsx)(B.a,{title:"Add members",visible:e.visible,footer:null,onCancel:e.onClose,children:Object(R.jsxs)(g.a,{gutter:[0,20],children:[Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(P.a,{style:{width:"100%"},onSearch:v,options:p,onSelect:function(e,t){if(O([]),0===o.filter((function(e){return e.id===t.key})).length){var n={id:t.key,name:t.value};s((function(e){return e.concat([n])}))}},children:Object(R.jsx)(_.a.Search,{size:"large",placeholder:"Add members",enterButton:!0})})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)("strong",{children:"Members"})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(D.a.Group,{maxCount:5,children:o.map((function(e){return Object(R.jsx)(L,{showToolTip:!0,showRemove:!0,userData:e,onRemove:y},e.id)}))})}),Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(x.a,{block:!0,type:"primary",onClick:function(){var e={board_id:t,members:o.map((function(e){return e.id}))};f.a.put("/boards",e).then((function(e){var t=e.data,n=t.success,a=t.data,r=t.error;n?(console.log(a),h.b.success("Successfully updated members")):(h.b.error("Failed to update members"),console.error(r))}),(function(e){h.b.error("Failed to update members"),console.error(e)}))},children:"Update"})})]})})},de=(n(152),O.a.Header),ue=O.a.Content;function je(e){var t=Object(a.useState)(!0),n=Object(d.a)(t,2),r=(n[0],n[1]),c=Object(a.useState)(!1),o=Object(d.a)(c,2),s=o[0],u=o[1],j=Object(a.useState)([]),b=Object(d.a)(j,2),p=b[0],y=b[1],C=Object(a.useContext)(I),T=C.globalState,w=C.globalDispatch;Object(a.useEffect)((function(){(function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=T.userData.boards).length&&f.a.get("/boards/multiple",{params:{boardIds:JSON.stringify(t)},paramsSerializer:function(e){return k.a.stringify(e)}}).then((function(e){var t=e.data,n=t.success,a=t.error,r=t.data;n?(console.log("--------------BOARD DATA--------------"),console.log(r),y(r)):console.log(a)}),(function(e){console.error("GET /boards/multiple",e)})),r(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var S=function(e){console.log("DELETE board_id",e),f.a.delete("/boards",{params:{board_id:e}}).then((function(t){if(!t.data.success)throw new Error(t.data.error);y((function(t){return w({type:"BOARD_DELETE",board_id:e}),t.filter((function(t){return t.id!==e})).map((function(e){return e.id}))})),h.b.success("Board deleted successfully")}),(function(e){throw new Error(e)})).catch((function(e){h.b.error("Failed to delete board"),console.error("DELETE /boards : ",e)}))};return Object(R.jsxs)(O.a,{className:"transparent-bg padding fullscreen",style:{backgroundColor:"transparent"},children:[Object(R.jsx)(de,{className:"transparent-bg header",style:{backgroundColor:"transparent",paddingLeft:0,paddingRight:0},children:Object(R.jsxs)(g.a,{justify:"space-between",align:"middle",children:[Object(R.jsx)("div",{className:"title",children:"Boards"}),Object(R.jsx)(x.a,{type:"primary",onClick:function(){u(!0)},children:"Create Board"})]})}),Object(R.jsx)(ue,{children:p.length?Object(R.jsx)(g.a,{gutter:[40,40],children:p.map((function(e){return Object(R.jsx)(m.a,{span:8,children:Object(R.jsx)(J,{boardData:e,onDelete:S})},e.id)}))}):Object(R.jsx)(v.a.Text,{type:"secondary",children:"No boards created yet"})}),Object(R.jsx)(F,{visible:s,onClose:function(){u(!1)},onCreate:function(e){y((function(t){return w({type:"BOARD_ADD",board_id:e.id}),t.concat(e)}))}})]})}var be=n(315),fe=n(327),pe=n(328),Oe=n(329);n(241);function he(e){var t=e.formType,n=e.formTitle,r=e.url,c=e.footer,o=Object(j.g)(),s=Object(a.useContext)(I),i=s.globalState,l=s.globalDispatch;i.isAuthenticated&&o.replace("/boards");return Object(R.jsx)("div",{className:"main",children:Object(R.jsx)("div",{className:"box",bordered:!1,children:Object(R.jsxs)(be.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){f.a.post(r,e,{headers:{"Content-Type":"application/json"}}).then((function(e){var n=e.data,a=n.success,r=n.error,c=n.data;a?(l({type:"LOGIN",userData:c}),o.push("/boards")):(h.b.error("Failed to ".concat(t)),console.error(r))}),(function(e){h.b.error("Failed to ".concat(t)),console.error(e)}))},children:[Object(R.jsx)(v.a.Title,{style:{color:"rgba(0,0,0,0.8)",textAlign:"center"},level:2,children:n}),"signup"===t&&Object(R.jsx)(be.a.Item,{name:"name",rules:[{required:!0,message:"Name can't be empty"}],children:Object(R.jsx)(_.a,{prefix:Object(R.jsx)(fe.a,{className:"site-form-item-icon"}),placeholder:"Name",size:"large",allowClear:!0,className:"rounded"})}),Object(R.jsx)(be.a.Item,{name:"email",rules:[{required:!0,type:"email",message:"Please enter valid email"}],children:Object(R.jsx)(_.a,{prefix:Object(R.jsx)(pe.a,{}),placeholder:"Email",size:"large",allowClear:!0,className:"rounded"})}),Object(R.jsx)(be.a.Item,{name:"password",rules:[{required:!0,message:"Password can't be empty"}],children:Object(R.jsx)(_.a.Password,{prefix:Object(R.jsx)(Oe.a,{}),placeholder:"Password",size:"large",allowClear:!0,className:"rounded"})}),Object(R.jsxs)(g.a,{gutter:[0,10],children:[Object(R.jsx)(m.a,{span:24,children:Object(R.jsx)(x.a,{type:"primary",htmlType:"submit",className:"login-form-button",shape:"round",children:"login"===t?"Log in":"Register"})}),c&&Object(R.jsx)(m.a,{span:24,children:c})]})]})})})}function ge(e){return Object(R.jsx)(he,{formType:"login",url:"/login",formTitle:"Login",footer:Object(R.jsxs)(R.Fragment,{children:["No accounts yet ?"," ",Object(R.jsx)("strong",{children:Object(R.jsx)(u.b,{to:"/signup",children:"Register now !"})})]})})}function xe(e){return Object(R.jsx)(he,{formType:"signup",url:"/signup",formTitle:"Signup",footer:Object(R.jsxs)(R.Fragment,{children:["Already have an account ?"," ",Object(R.jsx)("strong",{children:Object(R.jsx)(u.b,{to:"/login",children:"Login here"})})]})})}var me=n(323),ve=n(330),ye=n(331),ke=O.a.Header,Ce=O.a.Content;function Te(e){var t=Object(j.h)().board_id,n="/".concat(t,"/dashboard"),r="".concat(n,"/task"),c=Object(a.useState)(!1),o=Object(d.a)(c,2),s=o[0],u=o[1],b=Object(a.useState)(!0),v=Object(d.a)(b,2),y=v[0],k=v[1],C=Object(a.useState)({}),T=Object(d.a)(C,2),D=T[0],A=T[1],E=Object(a.useState)(!1),L=Object(d.a)(E,2),N=L[0],B=L[1],_=Object(a.useState)([]),P=Object(d.a)(_,2),F=P[0],z=P[1],G=Object(a.useContext)(I).globalState,H=Object(j.g)();console.log("STAGE DASHBOARD",F),Object(a.useEffect)((function(){(function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.a.get(n).then((function(e){var t=e.data,n=t.success,a=t.error,r=t.data;if(n){var c=r.stages,o=Object(S.a)(r,["stages"]);console.log("--------------DASHBOARD DATA--------------"),console.log(r),A(o),z(c)}else H.push("/404"),console.error(a)}),(function(e){H.push("/boards"),console.error("GET /".concat(t,"/dashboard/"),e)})),k(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t]);var U=function(){var e=Object(l.a)(i.a.mark((function e(t,n,a){var c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),c=F.filter((function(e){return e.id===t}))[0].tasks.length,o={stage_id:t,title:n,position:c},console.log("PAYLOAD",o),console.log("addTask request starting...."),e.next=7,f.a.post(r,o).then((function(e){console.log("got some response at line 82....",e.data);var n=e.data,r=n.success,o=n.error,s=n.data;if(r){var i=Object(w.a)(Object(w.a)({},s),{},{position:c});z((function(e){return e.map((function(e){return e.id===t?Object(w.a)(Object(w.a)({},e),{},{tasks:e.tasks.concat(i)}):e}))})),a(s,o)}}),(function(e){console.log("got error at line 86....",e),a(null,e)})).finally((function(){console.log("setUploading to false...."),u(!1)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(i.a.mark((function e(t,n,a){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(!0),c={task_id:t,stage_id:n},f.a.delete(r,{data:c}).then((function(e){var r=e.data,c=r.success,o=r.error,s=r.data;c&&(z((function(e){return e.map((function(e){return e.id===n?Object(w.a)(Object(w.a)({},e),{},{tasks:e.tasks.filter((function(e){return e.id!==t}))}):e}))})),a(s,o))}),(function(e){a(null,e)})).finally((function(){console.log("deleted task...."),u(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),q=function(){var e=Object(l.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(!0),console.log("updateTask line 105"),f.a.put(r,t).then((function(e){var t=e.data,a=t.error,r=t.success;return console.log("FINAL RESPONSE",e.data),r?n():n(a)}),(function(e){return n(e)})).finally((function(){console.log("updated task...."),u(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("updateStages PAYLOAD",t),f.a.put(n,t).then((function(e){var t=e.data,n=t.error;return t.success?a():a(n)}),(function(e){return a(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(l.a)(i.a.mark((function e(t,n,a,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q({task_id:t,assigned_id:n,assignedType:a},r);case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),V=function(e,t,n){W(e,t,"ADD",n)},Y={addTask:U,deleteTask:J,joinTask:function(e,t){V(e,G.userData.id,t)},addAssigned:V,removeAssigned:function(e,t,n){W(e,t,"DELETE",n)},moveTask:function(e,t,n,a,r){Z({source:{droppableId:t,index:a},destination:{droppableId:n,index:-1},callback:r})},changeTaskTitle:function(e,t,n){var a={task_id:e,title:t};console.log("changeTaskTitle line: 170"),q(a,n)},changeTaskDescription:function(e,t,n){q({task_id:e,description:t},n)},updateStages:M},K=function(e){return e.tasks=e.tasks.filter((function(e){return null!=e})).map((function(e,t){return e.position=t,e})),e},Q=function(e,t){console.log("BEFORE REORDER stages",F);var n=e.droppableId,a=e.index,r=t.index;console.log("REORDER SOURCE",e),console.log("REORDER DEST",t);var c=F.map((function(e){return e.id})).indexOf(n),o=Object(w.a)({},F[c]);console.log("BEFORE STAGE",o);var s=o.tasks.splice(a,1),i=Object(d.a)(s,1)[0];return o.tasks.splice(r,0,i),o=K(o),console.log("AFTER STAGE",o),{foundStage:o,stageIndex:c}},X=function(e,t){var n=F.map((function(e){return e.id})).indexOf(e.droppableId),a=F.map((function(e){return e.id})).indexOf(t.droppableId),r=F[n],c=F[a],o=r.tasks.splice(e.index,1),s=Object(d.a)(o,1)[0],i=t.index;return i=-1===i?c.tasks.length:i,c.tasks.splice(i,0,s),c=K(c),{fromStage:r=K(r),fromStageId:n,toStage:c,toStageId:a}},Z=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,a,r,c,o,s,l,d,j,b,f,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),n=t.source,a=t.destination,r=t.callback,c={stages:[]},a){e.next=6;break}return u(!1),e.abrupt("return");case 6:if(n.droppableId!==a.droppableId){e.next=15;break}if(n.index!==a.index){e.next=10;break}return u(!1),e.abrupt("return");case 10:o=Q(n,a),s=o.foundStage,l=o.stageIndex,c.stages=[s],z((function(e){return e.map((function(e,t){return t===l?s:e}))})),e.next=18;break;case 15:d=X(n,a),j=d.fromStage,b=d.fromStageId,f=d.toStage,p=d.toStageId,c.stages=[j,f],z((function(e){var t=Object(ae.a)(e);return t[b]=j,t[p]=f,t}));case 18:M(c,(function(e){u(!1),e?h.b.error("Failed to update dashboard"):r&&r()}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=Object(R.jsx)("div",{style:{minWidth:"100hw",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(R.jsx)(p.PropagateLoader,{color:"#1890ff",size:30})});return y?$:Object(R.jsx)(te.a,{onDragEnd:Z,children:Object(R.jsx)(O.a,{style:{backgroundColor:"transparent"},children:Object(R.jsxs)(O.a,{style:{paddingTop:0,paddingRight:32,paddingLeft:32,backgroundColor:"transparent"},children:[Object(R.jsx)(ke,{style:{backgroundColor:"transparent",paddingLeft:0,paddingRight:0},children:Object(R.jsxs)(g.a,{align:"middle",children:[Object(R.jsx)(m.a,{span:12,children:Object(R.jsx)("div",{className:"title",children:D.name})}),Object(R.jsx)(m.a,{span:12,children:Object(R.jsx)(g.a,{align:"end",justify:"middle",children:Object(R.jsxs)(me.b,{children:[Object(R.jsx)(m.a,{children:s?Object(R.jsx)(ve.a,{spin:!0,style:{color:"red",fontSize:20}}):Object(R.jsx)(ye.a,{twoToneColor:"#52c41a",style:{fontSize:20}})}),Object(R.jsxs)(m.a,{children:[Object(R.jsx)(x.a,{type:"primary",onClick:function(){B(!0)},children:"Add members"}),Object(R.jsx)(le,{visible:N,onClose:function(){B(!1)}})]})]})})})]})}),Object(R.jsx)(Ce,{children:Object(R.jsx)(g.a,{gutter:[0,12],children:F.map((function(e){return Object(R.jsx)("div",{style:{marginRight:10,width:250},children:Object(R.jsx)(oe,{stageData:e,methods:Y,stagesList:F})},e.id)}))})})]})})})}n(309);var we=function(){var e=Object(a.useState)(!0),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useContext)(I),o=c.globalState,s=c.globalDispatch;return Object(a.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/login").then((function(e){var t=e.data,n=t.success,a=t.data;console.log("APP",e.data),n&&s({type:"LOGIN",userData:a})}),(function(e){console.error(e)}));case 2:r(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();o.isAuthenticated||e()}),[s,o.isAuthenticated]),n?Object(R.jsx)("div",{style:{minWidth:"100hw",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(R.jsx)(p.PropagateLoader,{color:"#1890ff",size:30})}):Object(R.jsx)(u.a,{children:Object(R.jsxs)(j.d,{children:[Object(R.jsx)(j.b,{path:"/",exact:!0,children:Object(R.jsx)(j.a,{to:"/boards"})}),Object(R.jsx)(j.b,{path:"/login",exact:!0,children:M(Object(R.jsx)(ge,{}))}),Object(R.jsx)(j.b,{path:"/signup",exact:!0,children:M(Object(R.jsx)(xe,{}))}),Object(R.jsx)(W,{exact:!0,path:"/boards",component:je}),Object(R.jsx)(W,{exact:!0,path:"/:board_id/dashboard",component:Te}),Object(R.jsx)(j.b,{path:"*",children:M(Object(R.jsx)(ie,{}))})]})})};var Se={isAuthenticated:!1,userData:{}},De=function(e,t){switch(t.type){case"LOGIN":return function(e,t){var n=t.userData;return Object(w.a)(Object(w.a)({},e),{},{isAuthenticated:!0,userData:n})}(e,t);case"LOGOUT":return function(e,t){return Object(w.a)(Object(w.a)({},e),{},{isAuthenticated:!1})}(e);case"BOARD_ADD":return function(e,t){var n=t.board_id;return e.userData.boards.push(n),e}(e,t);case"BOARD_DELETE":return function(e,t){var n=t.board_id,a=e.userData.boards.filter((function(e){return e!==n}));return e.userData.boards=a,e}(e,t);default:return e}},Ae=function(){var e=Object(a.useReducer)(De,Se),t=Object(d.a)(e,2);return{globalState:t[0],globalDispatch:t[1]}};var Ee=function(e){var t=e.children;return Object(R.jsx)(I.Provider,{value:Ae(),children:t})};o.a.render(Object(R.jsx)(r.a.StrictMode,{children:Object(R.jsx)(Ee,{children:Object(R.jsx)(we,{})})}),document.getElementById("root"))}},[[310,1,2]]]);
//# sourceMappingURL=main.2a464892.chunk.js.map